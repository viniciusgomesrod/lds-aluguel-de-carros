<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<title>AutoRent - Editar Perfil</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://use.fontawesome.com/releases/v6.3.0/css/all.css" rel="stylesheet">
<style>
:root { --primary:#2c3e50; --secondary:#e74c3c; --light:#ecf0f1; }
body { font-family:'Roboto Slab',sans-serif; color:var(--primary);}
.navbar-dark { background-color:var(--primary)!important; }
.page-header { background-color:var(--light); padding:5rem 0 3rem; text-align:center;}
.page-header .heading { font-family:'Montserrat',sans-serif; font-size:2.5rem; font-weight:700; color:var(--primary);}
.card { transition:transform 0.3s, box-shadow 0.3s; border-radius:10px; border:none; margin-bottom:20px;}
.card:hover { transform:translateY(-5px); box-shadow:0 10px 20px rgba(0,0,0,0.1);}
.btn-primary { background-color:var(--secondary); border-color:var(--secondary);}
.btn-primary:hover { background-color:#c0392b; border-color:#c0392b;}
</style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark fixed-top">
    <div class="container">
        <a class="navbar-brand" href="#"><h3>AutoRent - Editar Perfil</h3></a>
        <div class="navbar-nav ms-auto">
            <a class="nav-link" th:href="@{/dashboardCliente}"><i class="fas fa-arrow-left me-1"></i> Voltar ao Dashboard</a>
        </div>
    </div>
</nav>

<header class="page-header">
    <div class="container">
        <div class="heading text-uppercase">Editar Perfil</div>
        <p class="text-muted mt-3">Atualize suas informações pessoais.</p>
    </div>
</header>

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-user-edit me-2"></i>Informações Pessoais</h5>
                </div>
                <div class="card-body">
                    <form th:action="@{/clientes/atualizar}" method="post" th:object="${cliente}">
                        <input type="hidden" th:field="*{id}">

                        <!-- Dados Pessoais -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="nome" class="form-label">Nome Completo</label>
                                <input type="text" class="form-control" id="nome" th:field="*{nome}" required>
                            </div>
                            <div class="col-md-6">
                                <label for="email" class="form-label">Email</label>
                                <input type="email" class="form-control" id="email" th:field="*{email}" required>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="cpf" class="form-label">CPF</label>
                                <input type="text" class="form-control" id="cpf" th:field="*{CPF}" required>
                            </div>
                            <div class="col-md-6">
                                <label for="rg" class="form-label">RG</label>
                                <input type="text" class="form-control" id="rg" th:field="*{rg}" required>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="telefone" class="form-label">Telefone</label>
                                <input type="text" class="form-control" id="telefone" th:field="*{telefone}" required>
                            </div>
                            <div class="col-md-6">
                                <label for="profissao" class="form-label">Profissão</label>
                                <input type="text" class="form-control" id="profissao" th:field="*{profissao}">
                            </div>
                        </div>

                        <!-- Senha -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="senha" class="form-label">Nova Senha</label>
                                <input type="password" class="form-control" id="senha" th:field="*{senha}" placeholder="Deixe em branco para manter a atual">
                            </div>
                            <div class="col-md-6">
                                <label for="confirmarSenha" class="form-label">Confirmar Nova Senha</label>
                                <input type="password" class="form-control" id="confirmarSenha" placeholder="Confirme a nova senha">
                            </div>
                        </div>

                        <!-- Endereço -->
                        <h6 class="mt-4 mb-3">Endereço</h6>
                        <div class="row mb-3">
                            <div class="col-md-8">
                                <label for="logradouro" class="form-label">Logradouro</label>
                                <input type="text" class="form-control" id="logradouro" th:field="*{endereco.logradouro}">
                            </div>
                            <div class="col-md-4">
                                <label for="numero" class="form-label">Número</label>
                                <input type="text" class="form-control" id="numero" th:field="*{endereco.numero}">
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="bairro" class="form-label">Bairro</label>
                                <input type="text" class="form-control" id="bairro" th:field="*{endereco.bairro}">
                            </div>
                            <div class="col-md-4">
                                <label for="cidade" class="form-label">Cidade</label>
                                <input type="text" class="form-control" id="cidade" th:field="*{endereco.cidade}">
                            </div>
                            <div class="col-md-4">
                                <label for="estado" class="form-label">Estado</label>
                                <input type="text" class="form-control" id="estado" th:field="*{endereco.estado}">
                            </div>
                        </div>

                        <div class="row mb-4">
                            <div class="col-md-6">
                                <label for="cep" class="form-label">CEP</label>
                                <input type="text" class="form-control" id="cep" th:field="*{endereco.cep}">
                            </div>
                        </div>

                        <!-- Rendimentos -->
                        <h6 class="mt-4 mb-3">Rendimentos Auferidos (máximo 3)</h6>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="rendimento1" class="form-label">Rendimento 1</label>
                                <input type="number" class="form-control" id="rendimento1" 
                                       th:field="*{rendimentosAuferidos[0]}" step="0.01" min="0">
                            </div>
                            <div class="col-md-4">
                                <label for="rendimento2" class="form-label">Rendimento 2</label>
                                <input type="number" class="form-control" id="rendimento2" 
                                       th:field="*{rendimentosAuferidos[1]}" step="0.01" min="0">
                            </div>
                            <div class="col-md-4">
                                <label for="rendimento3" class="form-label">Rendimento 3</label>
                                <input type="number" class="form-control" id="rendimento3" 
                                       th:field="*{rendimentosAuferidos[2]}" step="0.01" min="0">
                            </div>
                        </div>

                        <!-- Botões -->
                        <div class="d-flex justify-content-between">
                            <a th:href="@{/dashboardCliente}" class="btn btn-secondary">
                                <i class="fas fa-times me-2"></i> Cancelar
                            </a>
                            <div>
                                <button type="submit" class="btn btn-primary me-2">
                                    <i class="fas fa-save me-2"></i> Salvar Alterações
                                </button>
                                <a th:href="@{/clientes/excluir/{id}(id=${cliente.id})}" 
                                   class="btn btn-danger"
                                   onclick="return confirm('Tem certeza que deseja excluir sua conta? Esta ação não pode ser desfeita.')">
                                    <i class="fas fa-trash me-2"></i> Excluir Conta
                                </a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
// Máscaras
const cpfInput = document.getElementById('cpf');
if(cpfInput){cpfInput.addEventListener('input', e=>{
let v=e.target.value.replace(/\D/g,'');
v=v.replace(/(\d{3})(\d)/,'$1.$2');
v=v.replace(/(\d{3})(\d)/,'$1.$2');
v=v.replace(/(\d{3})(\d{1,2})$/,'$1-$2');
e.target.value=v.slice(0,14);});}

const rgInput = document.getElementById('rg');
if(rgInput){rgInput.addEventListener('input', e=>{
e.target.value=e.target.value.replace(/\D/g,'').slice(0,9);});}

const telefoneInput = document.getElementById('telefone');
if(telefoneInput){telefoneInput.addEventListener('input', e=>{
let v=e.target.value.replace(/\D/g,'');
v=v.replace(/^(\d{2})(\d)/,'($1) $2');
v=v.replace(/(\d{5})(\d)/,'$1-$2');
e.target.value=v.slice(0,15);});}

const cepInput = document.getElementById('cep');
if(cepInput){cepInput.addEventListener('input', e=>{
let v=e.target.value.replace(/\D/g,'');
v=v.replace(/^(\d{5})(\d)/,'$1-$2');
e.target.value=v.slice(0,9);});}

// Validação de senha
document.getElementById('confirmarSenha').addEventListener('input', function() {
    const senha = document.getElementById('senha').value;
    const confirmarSenha = this.value;
    this.setCustomValidity(senha !== confirmarSenha ? 'As senhas não coincidem' : '');
});
document.getElementById('senha').addEventListener('input', function() {
    const confirmarSenha = document.getElementById('confirmarSenha');
    if(confirmarSenha.value) confirmarSenha.dispatchEvent(new Event('input'));
});
</script>
</body>
</html>
